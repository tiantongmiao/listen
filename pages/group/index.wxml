<!--index.wxml-->
<view class="container">
<scroll-view scroll-y="true"
  style="width: 100%; height: 400px;"
  refresher-enabled="{{true}}"
  refresher-triggered="{{triggered}}"
  refresher-threshold="100"
  bindscrolltolower="onScrollToLower"
  bindrefresherrefresh="onRefresh"
>
  <!-- 循环的列表 -->
  <view class="card" wx:for="{{listData}}" wx:key="index">
    <van-cell>
      <view class="clearfix">
          <view class="fl pr10">
            <image class="userImg" src='{{item.avatarUrl}}'></image>
          </view>
          <view class="fl text-left">
            <view>{{item.nickName}}</view>
            <view>时间</view>
          </view>
        </view>
        <view class="text-left">{{item.content}}</view>
        <view class="text-right">
          <!-- <van-icon class="pr20 font-size-20" name="chat-o" 
            data-showmessage="{{item.showMessage}}"
            data-index="{{index}}"
            bind:click="onShowMessage" /> -->
          <van-icon class="font-size-20 pr10" name="chat-o" 
            data-showedit="{{item.showEdit}}"
            data-index="{{index}}"
            bind:click="onShowEdit" />
            <!-- 管理员才有的删除功能 -->
            <van-icon class="font-size-20" name="close" bind:click="onDel" />
        </view>
        <!-- 消息展示区 -->
        <view class="message-view">
          <!-- 消息循环 -->
          <view class="flex-row message-view-text" 
            wx:for="{{item.messageList}}" wx:key="cindex" 
            wx:for-item="citem" wx:for-index="cindex">
            <view>{{citem.name}}：</view>
            <view class="flex-1 text-left">{{citem.message}}</view>
          </view>
        </view>
    </van-cell>
  </view>
</scroll-view>
<action-sheet hidden="{{hiddenEdit}}" bindchange="onShowEditChange" >
	<action-sheet-item >
		<textarea type="text" class="edit-view-textarea" placeholder="留下你想说的话..."           bindconfirm="obtainInput"/>
	</action-sheet-item>
	<!--自动隐藏action-sheet-->
	<action-sheet-cancel bindtap="showInput">确认</action-sheet-cancel>
</action-sheet>
  
</view>